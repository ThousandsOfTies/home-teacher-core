# ブラウザ互換性について

## File System Access API のサポート状況

このアプリは、PDFファイルをIndexedDBに保存せず、ファイルハンドルのみを保存することで、ストレージ容量を大幅に削減しています。

### サポートされているブラウザ

#### ✅ 完全サポート（File System Access API使用）
- **Chrome / Edge**: バージョン86以降
- **Opera**: バージョン72以降
- **デスクトップ版のChromiumベースブラウザ**

これらのブラウザでは：
- ファイルハンドルが保存され、元のファイルにアクセスできます
- IndexedDBにはサムネイルと描画データのみ保存されます
- ストレージ使用量が大幅に削減されます

#### ⚠️ 部分サポート（フォールバックモード）
- **Firefox**: すべてのバージョン
- **Safari**: すべてのバージョン
- **モバイルブラウザ**: iOS Safari, Chrome for Android など

これらのブラウザでは：
- 従来の`<input type="file">`を使用します
- ファイル全体がBase64でIndexedDBに保存されます
- ストレージ容量を多く使用します（大きいPDFの場合は注意）

### PWAとしてのインストール

#### デスクトップ
- **Chrome / Edge**: ✅ 完全サポート
- **Firefox**: ❌ PWAインストール非サポート（ブラウザとして使用可能）
- **Safari (macOS)**: ⚠️ 限定的なサポート

#### モバイル
- **Chrome for Android**: ✅ 完全サポート
- **Safari (iOS)**: ⚠️ 限定的なサポート（一部機能制限あり）

### 推奨環境

最高のユーザー体験のために、以下の環境を推奨します：

1. **デスクトップ**: Chrome または Edge（最新版）
2. **Android**: Chrome（最新版）
3. **iOS**: Safari（ただし機能制限あり）

### ストレージ容量の目安

#### File System Access API使用時
- サムネイル: 約20-50KB/PDF
- 描画データ: 約1-10KB/ページ
- **合計**: 通常50-200KB程度（ファイルサイズに関わらず）

#### フォールバックモード（Firefox/Safari）
- PDFファイル全体を保存
- **合計**: PDFファイルサイズ + サムネイル + 描画データ

### 注意事項

1. **ファイルの移動・削除**: File System Access APIを使用している場合、元のPDFファイルを移動・削除すると、アプリからアクセスできなくなります
2. **権限の再確認**: ブラウザを再起動した後、初回アクセス時にファイルへの権限確認が表示される場合があります
3. **オフライン動作**: フォールバックモードの場合のみ、完全なオフライン動作が可能です

## 互換性チェック方法

アプリを開いた際、自動的に最適な方法が選択されます：

```javascript
if ('showOpenFilePicker' in window) {
  // File System Access APIを使用（推奨）
} else {
  // フォールバック: 従来の方法を使用
}
```

ユーザーに特別な操作は必要ありません。
